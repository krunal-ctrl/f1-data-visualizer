import{a as ye}from"./chunk-IQOTOQLL.js";import{a as k,b as he,c as fe,f as xe,g as V}from"./chunk-Q2AQ2DAQ.js";import"./chunk-PT2JM3JA.js";import{b as me,c as pe,d as ce,e as ge,f as ve,g as ue}from"./chunk-IJ6G24IL.js";import{a as de}from"./chunk-SJCQLIIU.js";import{a as oe,b as se,c as le}from"./chunk-TE33ORRB.js";import{k as re}from"./chunk-XWUIZVU3.js";import{$ as Y,Ab as _,Ba as o,Cb as q,Db as G,Eb as J,F as Z,Hb as F,Lb as O,Pb as y,Qb as ne,Ra as w,Va as u,W as X,a as K,aa as $,ab as p,b as H,bb as i,cb as t,db as b,gc as ae,hb as T,hc as A,ib as R,ic as W,ja as D,jb as N,kb as ee,kc as I,mb as f,pb as te,qb as ie,rb as z,sb as j,ub as M,x as U,xb as r,yb as x,zb as h}from"./chunk-VMW2IAQ2.js";var Le=s=>({model:s});function Ee(s,a){s&1&&N(0)}function Te(s,a){if(s&1&&u(0,Ee,1,0,"ng-container",4),s&2){let e=a.model,n=f(2);p("ngTemplateOutlet",n.tooltipTemplateRef)("ngTemplateOutletContext",F(2,Le,e))}}function Re(s,a){s&1&&(T(0),u(1,Te,1,4,"ng-template",null,0,O),R())}var B=class s{data=[];xAxisLabel="";yAxisLabel="";showLegend=!0;height=300;tooltipTemplate;showXAxis=!0;showYAxis=!0;gradient=!0;showXAxisLabel=!0;showYAxisLabel=!0;timeline=!0;autoScale=!0;tooltipTemplateRef;colorScheme={name:"custom",selectable:!0,group:k.Ordinal,domain:["#00f0ff","#dc0000","#ff8700","#0090ff","#00d2be"]};static \u0275fac=function(e){return new(e||s)};static \u0275cmp=w({type:s,selectors:[["app-area-chart"]],inputs:{data:"data",xAxisLabel:"xAxisLabel",yAxisLabel:"yAxisLabel",showLegend:"showLegend",height:"height",tooltipTemplate:"tooltipTemplate",tooltipTemplateRef:"tooltipTemplateRef"},decls:3,vars:15,consts:[["tooltipTemplate",""],[1,"chart-container"],[3,"results","xAxis","yAxis","legend","showXAxisLabel","showYAxisLabel","xAxisLabel","yAxisLabel","timeline","autoScale","gradient","scheme"],[4,"ngIf"],[4,"ngTemplateOutlet","ngTemplateOutletContext"]],template:function(e,n){e&1&&(i(0,"div",1)(1,"ngx-charts-area-chart",2),u(2,Re,3,0,"ng-container",3),t()()),e&2&&(M("height",n.height,"px"),o(),p("results",n.data)("xAxis",n.showXAxis)("yAxis",n.showYAxis)("legend",n.showLegend)("showXAxisLabel",n.showXAxisLabel)("showYAxisLabel",n.showYAxisLabel)("xAxisLabel",n.xAxisLabel)("yAxisLabel",n.yAxisLabel)("timeline",n.timeline)("autoScale",n.autoScale)("gradient",n.gradient)("scheme",n.colorScheme),o(),p("ngIf",n.tooltipTemplateRef))},dependencies:[I,A,W,V,fe],encapsulation:2})};var Ne=["host"],Me=s=>({model:s});function Fe(s,a){s&1&&N(0)}function Oe(s,a){if(s&1&&u(0,Fe,1,0,"ng-container",4),s&2){let e=a.model,n=f(2);p("ngTemplateOutlet",n.tooltipTemplateRef)("ngTemplateOutletContext",F(2,Me,e))}}function We(s,a){s&1&&(T(0),u(1,Oe,1,4,"ng-template",null,0,O),R())}var Q=class s{data=[];xAxisLabel="";yAxisLabel="";showLegend=!1;height=300;customColors=[];showLabels=!0;legendTitle="";chart;gradient=!1;isDoughnut=!1;ro;host;tooltipTemplateRef;ngAfterViewInit(){setTimeout(()=>this.chart.update(),0)}colorScheme={name:"custom",selectable:!0,group:k.Ordinal,domain:["#00f0ff","#dc0000","#ff8700","#0090ff","#00d2be"]};static \u0275fac=function(e){return new(e||s)};static \u0275cmp=w({type:s,selectors:[["app-pie-chart"]],contentQueries:function(e,n,d){if(e&1&&te(d,he,5),e&2){let c;z(c=j())&&(n.chart=c.first)}},viewQuery:function(e,n){if(e&1&&ie(Ne,7),e&2){let d;z(d=j())&&(n.host=d.first)}},inputs:{data:"data",xAxisLabel:"xAxisLabel",yAxisLabel:"yAxisLabel",showLegend:"showLegend",height:"height",customColors:"customColors",showLabels:"showLabels",legendTitle:"legendTitle",tooltipTemplateRef:"tooltipTemplateRef"},decls:3,vars:10,consts:[["tooltipTemplate",""],[1,"chart-container"],[3,"results","legend","labels","gradient","doughnut","scheme","legendTitle"],[4,"ngIf"],[4,"ngTemplateOutlet","ngTemplateOutletContext"]],template:function(e,n){e&1&&(i(0,"div",1)(1,"ngx-charts-pie-chart",2),u(2,We,3,0,"ng-container",3),t()()),e&2&&(M("height",n.height,"px"),o(),p("results",n.data)("legend",n.showLegend)("labels",n.showLabels)("gradient",n.gradient)("doughnut",n.isDoughnut)("scheme",n.colorScheme)("legendTitle",n.legendTitle),o(),p("ngIf",n.tooltipTemplateRef))},dependencies:[I,A,W,V,xe],styles:[".bar-tooltip{background:#1a1a1afa;border:1px solid #00f0ff;border-radius:8px;padding:12px;box-shadow:0 4px 20px #00f0ff4d;min-width:180px}  .bar-tooltip .tooltip-header{color:#00f0ff;font-size:14px;font-weight:600;margin-bottom:8px}  .bar-tooltip .tooltip-content{display:flex;flex-direction:column;gap:4px}  .bar-tooltip .tooltip-row{display:flex;justify-content:space-between;font-size:12px}  .bar-tooltip .tooltip-label{color:#9ca3af}  .bar-tooltip .tooltip-value{color:#fff;font-weight:600}  ngx-tooltip-content:has(.bar-tooltip),   .ngx-charts-tooltip-content:has(.bar-tooltip){background:transparent!important}"]})};function ke(s,a){s&1&&b(0,"app-loading")}function Ve(s,a){if(s&1&&(i(0,"option",41),r(1),t()),s&2){let e=a.$implicit;p("value",e.Driver.driverId),o(),_(" ",e.Driver.givenName," ",e.Driver.familyName," ")}}function Be(s,a){if(s&1&&(i(0,"option",41),r(1),t()),s&2){let e=a.$implicit;p("value",e.Driver.driverId),o(),_(" ",e.Driver.givenName," ",e.Driver.familyName," ")}}function Qe(s,a){if(s&1&&(i(0,"div",42)(1,"div",43)(2,"h3",44),r(3),t(),i(4,"div",45)(5,"div",46)(6,"span",47),r(7,"Position:"),t(),i(8,"span",48),r(9),t()(),i(10,"div",46)(11,"span",47),r(12,"Points:"),t(),i(13,"span",19),r(14),t()(),i(15,"div",46)(16,"span",47),r(17,"Wins:"),t(),i(18,"span",48),r(19),t()(),i(20,"div",46)(21,"span",47),r(22,"Avg Points/Race:"),t(),i(23,"span",48),r(24),t()()()(),i(25,"div",43)(26,"h3",44),r(27),t(),i(28,"div",45)(29,"div",46)(30,"span",47),r(31,"Position:"),t(),i(32,"span",48),r(33),t()(),i(34,"div",46)(35,"span",47),r(36,"Points:"),t(),i(37,"span",19),r(38),t()(),i(39,"div",46)(40,"span",47),r(41,"Wins:"),t(),i(42,"span",48),r(43),t()(),i(44,"div",46)(45,"span",47),r(46,"Avg Points/Race:"),t(),i(47,"span",48),r(48),t()()()()()),s&2){let e=f(2);o(3),x(e.comparisonData().driver1.name),o(6),h("P",e.comparisonData().driver1.position),o(5),x(e.comparisonData().driver1.points),o(5),x(e.comparisonData().driver1.wins),o(5),x(e.comparisonData().driver1.avgPointsPerRace),o(3),x(e.comparisonData().driver2.name),o(6),h("P",e.comparisonData().driver2.position),o(5),x(e.comparisonData().driver2.points),o(5),x(e.comparisonData().driver2.wins),o(5),x(e.comparisonData().driver2.avgPointsPerRace)}}function Xe(s,a){if(s&1&&(i(0,"div"),b(1,"app-bar-chart",49),t()),s&2){let e=f(2);o(),p("data",e.comparisonChartData()[0].series)("height",300)}}function Ye(s,a){if(s&1){let e=ee();i(0,"div",3)(1,"div")(2,"h1",4),r(3,"Analytics Dashboard"),t(),i(4,"p",5),r(5,"Advanced insights and performance analysis"),t()(),i(6,"div",6)(7,"div",7)(8,"div",8),r(9,"Championship Leader"),t(),i(10,"div",9),r(11),t(),i(12,"div",10),r(13),t()(),i(14,"div",7)(15,"div",8),r(16,"Most Wins"),t(),i(17,"div",9),r(18),t(),i(19,"div",10),r(20),t()(),i(21,"div",7)(22,"div",8),r(23,"Most Consistent"),t(),i(24,"div",9),r(25),t(),i(26,"div",10),r(27),t()(),i(28,"div",7)(29,"div",8),r(30,"Races Completed"),t(),i(31,"div",9),r(32),t(),i(33,"div",10),r(34),t()()(),i(35,"div",11)(36,"app-card",12)(37,"div",13)(38,"p",14),r(39," Based on current standings and remaining races "),t(),b(40,"app-pie-chart",15),i(41,"div",16)(42,"div",17),r(43,"Analysis"),t(),i(44,"div",18),r(45),i(46,"span",19),r(47),t(),r(48," chance of winning the championship. "),t()()()(),i(49,"app-card",20),b(50,"app-pie-chart",21),t()(),i(51,"div",22)(52,"app-card",23),b(53,"app-area-chart",24),t()(),i(54,"div",11)(55,"app-card",25),b(56,"app-bar-chart",26),t(),i(57,"app-card",27),b(58,"app-bar-chart",28),t()(),i(59,"div",22)(60,"app-card",29)(61,"div",3)(62,"div",30)(63,"div")(64,"label",31),r(65,"Driver 1"),t(),i(66,"select",32),J("ngModelChange",function(d){Y(e);let c=f();return G(c.selectedDriver1,d)||(c.selectedDriver1=d),$(d)}),u(67,Ve,2,3,"option",33),t()(),i(68,"div")(69,"label",31),r(70,"Driver 2"),t(),i(71,"select",32),J("ngModelChange",function(d){Y(e);let c=f();return G(c.selectedDriver2,d)||(c.selectedDriver2=d),$(d)}),u(72,Be,2,3,"option",33),t()()(),u(73,Qe,49,10,"div",34)(74,Xe,2,2,"div",1),t()(),i(75,"app-card",35)(76,"div",36)(77,"div",37)(78,"div",38)(79,"div",39),r(80,"\u{1F3C6}"),t(),i(81,"div",40),r(82,"Dominance"),t()(),i(83,"p",18),r(84),t()(),i(85,"div",37)(86,"div",38)(87,"div",39),r(88,"\u{1F4CA}"),t(),i(89,"div",40),r(90,"Consistency"),t()(),i(91,"p",18),r(92),t()(),i(93,"div",37)(94,"div",38)(95,"div",39),r(96,"\u26A1"),t(),i(97,"div",40),r(98,"Title Race"),t()(),i(99,"p",18),r(100),t()()()()()()}if(s&2){let e,n,d,c,g,v,C,P,S,m,l=f();o(11),h(" ",((e=l.statisticalLeaders().mostPoints)==null?null:e.Driver.familyName)||"-"," "),o(2),h(" ",((n=l.statisticalLeaders().mostPoints)==null?null:n.points)||"0"," points "),o(5),h(" ",((d=l.statisticalLeaders().mostWins)==null?null:d.Driver.familyName)||"-"," "),o(2),h(" ",((c=l.statisticalLeaders().mostWins)==null?null:c.wins)||"0"," victories "),o(5),h(" ",((g=l.statisticalLeaders().mostConsistent)==null?null:g.Driver.familyName)||"-"," "),o(2),h(" ",(((v=l.statisticalLeaders().mostConsistent)==null?null:v.consistency)||0).toFixed(1)," pts/race "),o(5),_(" ",l.getCompletedRaces()," / ",l.raceCalendar().length," "),o(2),h(" ",l.getRacesRemaining()," remaining "),o(6),p("data",l.championshipPrediction())("height",300)("showLegend",!0)("showLabels",!0),o(5),_(" With ",l.getRacesRemaining()," races remaining, ",(C=l.championshipPrediction()[0])==null?null:C.name," has a "),o(2),h("",(P=l.championshipPrediction()[0])==null?null:P.value,"%"),o(3),p("data",l.pointsDistribution())("height",350)("showLegend",!0),o(3),p("data",l.pointsProgressionData())("height",400)("showLegend",!0),o(3),p("data",l.winsDistribution())("height",350),o(2),p("data",l.teamPerformanceData())("height",350),o(8),q("ngModel",l.selectedDriver1),o(),p("ngForOf",l.drivers),o(4),q("ngModel",l.selectedDriver2),o(),p("ngForOf",l.drivers),o(),p("ngIf",l.comparisonData()),o(),p("ngIf",l.comparisonChartData().length>0),o(10),_(" ",((S=l.statisticalLeaders().mostWins)==null?null:S.Driver.familyName)||"N/A"," leads with ",((S=l.statisticalLeaders().mostWins)==null?null:S.wins)||0," wins this season "),o(8),_(" ",((m=l.statisticalLeaders().mostConsistent)==null?null:m.Driver.familyName)||"N/A"," averages ",(((m=l.statisticalLeaders().mostConsistent)==null?null:m.consistency)||0).toFixed(1)," points per race "),o(8),h(" ",l.getRacesRemaining()," races remaining to decide the championship ")}}var Ce=class s{apiService=X(le);seasonService=X(de);driverStandings=D(null);constructorStandings=D(null);raceCalendar=D([]);loading=D(!0);selectedDriver1=D("");selectedDriver2=D("");constructor(){ne(()=>{this.loadAnalyticsData(this.seasonService.selectedSeason())})}loadAnalyticsData(a){this.loading.set(!0),U({drivers:this.apiService.getDriverStandings(a),constructors:this.apiService.getConstructorStandings(a),races:this.apiService.getRaceCalendar(a)}).pipe(Z(()=>this.loading.set(!1))).subscribe({next:({drivers:e,constructors:n,races:d})=>{this.driverStandings.set(e),this.constructorStandings.set(n),this.raceCalendar.set(d||[]),e?.DriverStandings?.length>=2&&(this.selectedDriver1.set(e.DriverStandings[0].Driver.driverId),this.selectedDriver2.set(e.DriverStandings[1].Driver.driverId))},error:e=>{console.error("Error loading race data:",e)}})}championshipPrediction=y(()=>{let a=this.driverStandings()?.DriverStandings||[];if(a.length===0)return[];let e=this.getRacesRemaining(),n=this.getSprintRacesRemaining(),d=e*25,c=n*8,g=d+c,v=parseInt(a[0].points),C=a.filter(m=>parseInt(m.points)+g>=v);if(C.length===0)return[];let P=C.map(m=>{let l=parseInt(m.points),L=v-l,E;if(L===0)E=40+15/C.length;else if(L>=g)E=0;else{let Se=L/g,we=(parseInt(m.position)-1)*3,Ae=parseInt(m.wins)*2,Ie=(1-Se)*50;E=Math.max(1,Ie-we+Ae)}return{driver:m,points:l,winChance:E}}),S=P.reduce((m,l)=>m+l.winChance,0);return P.map(m=>({name:`${m.driver.Driver.givenName} ${m.driver.Driver.familyName}`,value:parseFloat((m.winChance/S*100).toFixed(1)),extra:{position:m.driver.position,points:m.points,wins:m.driver.wins,pointsGap:v-m.points}})).filter(m=>m.value>=.5)});pointsDistribution=y(()=>(this.driverStandings()?.DriverStandings||[]).slice(0,5).map(e=>({name:e.Driver.familyName,value:parseInt(e.points)})));winsDistribution=y(()=>(this.driverStandings()?.DriverStandings||[]).filter(e=>parseInt(e.wins)>0).map(e=>({name:e.Driver.familyName,value:parseInt(e.wins)})));teamPerformanceData=y(()=>(this.constructorStandings()?.ConstructorStandings||[]).map(e=>({name:e.Constructor.name,value:parseInt(e.points)})));pointsProgressionData=y(()=>{let a=this.driverStandings()?.DriverStandings?.slice(0,3)||[],e=this.raceCalendar().length;return a.map(n=>{let c=parseInt(n.points)/e;return{name:n.Driver.familyName,series:Array.from({length:e},(g,v)=>({name:`R${v+1}`,value:Math.floor(c*(v+1))}))}})});statisticalLeaders=y(()=>{let a=this.driverStandings()?.DriverStandings||[];if(a.length===0)return{mostPoints:null,mostWins:null,mostConsistent:null};let e=a[0],n=a.reduce((g,v)=>parseInt(v.wins)>parseInt(g.wins)?v:g),c=a.map(g=>H(K({},g),{consistency:parseInt(g.points)/this.raceCalendar().length})).reduce((g,v)=>v.consistency>g.consistency?v:g);return{mostPoints:e,mostWins:n,mostConsistent:c}});comparisonData=y(()=>{let a=this.driverStandings()?.DriverStandings||[],e=a.find(d=>d.Driver.driverId===this.selectedDriver1()),n=a.find(d=>d.Driver.driverId===this.selectedDriver2());return!e||!n?null:{driver1:{name:`${e.Driver.givenName} ${e.Driver.familyName}`,points:parseInt(e.points),wins:parseInt(e.wins),position:parseInt(e.position),avgPointsPerRace:(parseInt(e.points)/this.raceCalendar().length).toFixed(1)},driver2:{name:`${n.Driver.givenName} ${n.Driver.familyName}`,points:parseInt(n.points),wins:parseInt(n.wins),position:parseInt(n.position),avgPointsPerRace:(parseInt(n.points)/this.raceCalendar().length).toFixed(1)}}});comparisonChartData=y(()=>{let a=this.comparisonData();return a?[{name:"Points",series:[{name:a.driver1.name.split(" ")[1],value:a.driver1.points},{name:a.driver2.name.split(" ")[1],value:a.driver2.points}]},{name:"Wins",series:[{name:a.driver1.name.split(" ")[1],value:a.driver1.wins},{name:a.driver2.name.split(" ")[1],value:a.driver2.wins}]}]:[]});get drivers(){return this.driverStandings()?.DriverStandings||[]}getRacesRemaining(){let a=new Date;return this.raceCalendar().filter(e=>new Date(e.date)>a).length}getCompletedRaces(){let a=new Date;return this.raceCalendar().filter(e=>new Date(e.date)<=a).length}getSprintRacesRemaining(){let a=new Date;return this.raceCalendar().filter(n=>new Date(n.date)>a).filter(n=>n?.Sprint?.date).length}static \u0275fac=function(e){return new(e||s)};static \u0275cmp=w({type:s,selectors:[["app-analytics"]],decls:3,vars:2,consts:[[1,"max-w-7xl","mx-auto"],[4,"ngIf"],["class","space-y-6",4,"ngIf"],[1,"space-y-6"],[1,"text-3xl","font-bold","text-black","dark:text-white"],[1,"text-gray-400","mt-1"],[1,"grid","grid-cols-1","md:grid-cols-4","gap-6"],[1,"bg-f1-surface","rounded-lg","p-6","border","border-gray-800"],[1,"text-gray-400","text-sm","mb-2"],[1,"text-2xl","font-bold","text-black","dark:text-white"],[1,"text-f1-accent","text-sm","mt-1"],[1,"grid","grid-cols-1","lg:grid-cols-2","gap-6"],["title","Championship Prediction"],[1,"space-y-4"],[1,"text-gray-400","text-sm"],["legendTitle","Drivers",3,"data","height","showLegend","showLabels"],[1,"mt-4","p-4","bg-gray-100","dark:bg-gray-900","rounded-lg"],[1,"text-xs","text-gray-400","mb-2"],[1,"text-sm","text-gray-400"],[1,"text-f1-accent","font-bold"],["title","Points Distribution (Top 5)"],["legendTitle","Drivers",3,"data","height","showLegend"],[1,"grid","grid-cols-1","gap-6"],["title","Championship Battle - Points Progression"],["xAxisLabel","Race","yAxisLabel","Points",3,"data","height","showLegend"],["title","Race Wins Distribution"],["xAxisLabel","Driver","yAxisLabel","Wins",3,"data","height"],["title","Constructor Standings"],["xAxisLabel","Team","yAxisLabel","Points",3,"data","height"],["title","Driver Comparison"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4"],[1,"text-gray-400","text-sm","mb-2","block"],[1,"w-full","bg-gray-100","dark:bg-gray-900","text-black","dark:text-white","px-4","py-2","rounded-lg","border","border-gray-700","focus:outline-none","focus:border-f1-accent","transition-colors",3,"ngModelChange","ngModel"],[3,"value",4,"ngFor","ngForOf"],["class","grid grid-cols-1 md:grid-cols-2 gap-6",4,"ngIf"],["title","Key Insights"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-4"],[1,"bg-gray-100","dark:bg-gray-900","rounded-lg","p-4"],[1,"flex","items-center","gap-3","mb-2"],[1,"text-2xl"],[1,"text-sm","font-semibold","text-gray-700"],[3,"value"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-6"],[1,"bg-gray-100","dark:bg-gray-900","rounded-lg","p-6","border","border-gray-800"],[1,"text-lg","font-bold","text-black","dark:text-white","mb-4"],[1,"space-y-3"],[1,"flex","justify-between","items-center"],[1,"text-gray-400"],[1,"text-black","dark:text-white","font-bold"],["xAxisLabel","Driver","yAxisLabel","Value",3,"data","height"]],template:function(e,n){e&1&&(i(0,"div",0),u(1,ke,1,0,"app-loading",1)(2,Ye,101,37,"div",2),t()),e&2&&(o(),p("ngIf",n.loading()),o(),p("ngIf",!n.loading()))},dependencies:[I,ae,A,re,ue,ge,ve,ce,me,pe,oe,se,ye,Q,B],encapsulation:2})};export{Ce as Analytics};
