<div class="max-w-7xl mx-auto">
  <!-- Loading State -->
  <app-loading *ngIf="loading()"></app-loading>

  <!-- Dashboard Content -->
  <div *ngIf="!loading()" class="space-y-6">
    <!-- Hero Section -->
    <div
      class="relative bg-gradient-to-r from-f1-primary to-f1-surface rounded-2xl p-8 border border-gray-300 dark:border-gray-800 overflow-hidden">
      <div class="relative z-10">
        <h1 class="text-4xl font-bold text-black dark:text-white mb-2">
          Formula 1 {{ driverStandings()?.season }} Season
        </h1>
        <p class="text-gray-600 dark:text-gray-300 text-lg">
          Track live standings, race results, and driver performance
        </p>
      </div>
      <div class="absolute right-8 top-1/2 -translate-y-1/2 text-9xl opacity-10">üèéÔ∏è</div>
    </div>

    <!-- Quick Stats -->
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
      <app-stat-card *ngIf="getTopDrivers(1).length > 0" label="Championship Leader"
        [value]="getTopDrivers(1)[0]?.Driver?.familyName || '-'" icon="üëë"
        [subtitle]="getTopDrivers(1)[0]?.points + ' points'">
      </app-stat-card>

      <app-stat-card *ngIf="getTopTeams(1).length > 0" label="Leading Team"
        [value]="getTopTeams(1)[0]?.Constructor?.name || '-'" icon="üèÅ"
        [subtitle]="getTopTeams(1)[0]?.points + ' points'">
      </app-stat-card>

      <app-stat-card *ngIf="nextRace()" label="Next Race" [value]="getDaysUntilNextRace()" icon="üìÖ"
        subtitle="days away">
      </app-stat-card>

      <app-stat-card label="Races Completed" [value]="getCompletedRaces() + '/' + getTotalRaces()" icon="üèÜ"
        [subtitle]="'Round ' + getCurrentRound()">
      </app-stat-card>
    </div>

    <!-- Next Race Countdown -->
    <div class="grid grid-cols-1 gap-6" *ngIf="nextRace()">
      <app-card title="Next Race">
        <div class="flex flex-col md:flex-row items-start md:items-center justify-between gap-4">
          <div class="flex-1">
            <h3 class="text-2xl font-bold text-black dark:text-white mb-1">
              {{ nextRace()?.raceName }}
            </h3>
            <p class="text-gray-600 dark:text-gray-400">
              {{ nextRace()?.Circuit?.Location?.locality }}, {{ nextRace()?.Circuit?.Location?.country }}
            </p>
            <p class="text-f1-accent mt-2 font-medium">
              {{ nextRace()?.date }} ‚Ä¢ Round {{ nextRace()?.round }}
            </p>
          </div>
          <div class="text-center bg-gray-100 dark:bg-gray-900 rounded-lg p-6">
            <div class="text-5xl font-bold text-f1-accent">{{ getDaysUntilNextRace() }}</div>
            <div class="text-gray-600 dark:text-gray-400 mt-2">days to go</div>
          </div>
        </div>
      </app-card>
    </div>

    <!-- Driver Standings & Constructor Standings -->
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">

      <!-- Driver Standings -->
      <app-card title="Driver Standings" [noPadding]="true">
        <div class="overflow-x-auto">
          <table class="w-full">
            <thead class="bg-gray-100 dark:bg-gray-900">
              <tr>
                <th class="px-6 py-3 text-left text-xs font-medium text-gray-600 dark:text-gray-400 uppercase tracking-wider">Pos</th>
                <th class="px-6 py-3 text-left text-xs font-medium text-gray-600 dark:text-gray-400 uppercase tracking-wider">Driver</th>
                <th class="px-6 py-3 text-left text-xs font-medium text-gray-600 dark:text-gray-400 uppercase tracking-wider">Team</th>
                <th class="px-6 py-3 text-right text-xs font-medium text-gray-600 dark:text-gray-400 uppercase tracking-wider">Points</th>
              </tr>
            </thead>
            <tbody class="divide-y divide-gray-200 dark:divide-gray-800">
              <tr *ngFor="let standing of driverStandings()?.DriverStandings?.slice(0, 10); let i = index"
                class="hover:bg-gray-50 dark:hover:bg-gray-900 transition-colors cursor-pointer" [style.animation-delay.s]="i * 0.05">
                <td class="px-6 py-4 whitespace-nowrap">
                  <span class="inline-flex items-center justify-center w-8 h-8 rounded-full text-sm font-bold"
                    [class.bg-yellow-500]="standing.position === '1'" [class.text-black]="standing.position === '1'"
                    [class.bg-gray-400]="standing.position === '2'" [class.text-black]="standing.position === '2'"
                    [class.bg-orange-600]="standing.position === '3'" [class.text-white]="standing.position === '3'"
                    [class.bg-gray-200]="standing.position > '3'" [class.text-gray-800]="standing.position > '3'"
                    [class.dark:bg-gray-800]="standing.position > '3'" [class.dark:text-gray-300]="standing.position > '3'">
                    {{ standing.position }}
                  </span>
                </td>
                <td class="px-6 py-4 whitespace-nowrap">
                  <div class="flex items-center">
                    <div>
                      <div class="text-sm font-medium text-black dark:text-white">
                        {{ standing.Driver.givenName }} {{ standing.Driver.familyName }}
                      </div>
                      <div class="text-xs text-gray-600 dark:text-gray-400">{{ standing.Driver.code }}</div>
                    </div>
                  </div>
                </td>
                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-600 dark:text-gray-300">
                  {{ standing.Constructors[0]?.name }}
                </td>
                <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-bold text-f1-accent">
                  {{ standing.points }}
                </td>
              </tr>
            </tbody>
          </table>
        </div>
        <div class="px-6 py-4 bg-gray-100 dark:bg-gray-900 border-t border-gray-200 dark:border-gray-800">
          <a routerLink="/drivers"
            class="text-f1-accent hover:text-f1-accent/80 text-sm font-medium inline-flex items-center gap-2">
            View all drivers
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
            </svg>
          </a>
        </div>
      </app-card>

      <!-- Constructor Standings -->
      <app-card title="Constructor Standings" [noPadding]="true">
        <div class="overflow-x-auto">
          <table class="w-full">
            <thead class="bg-gray-100 dark:bg-gray-900">
              <tr>
                <th class="px-6 py-3 text-left text-xs font-medium text-gray-600 dark:text-gray-400 uppercase tracking-wider">Pos</th>
                <th class="px-6 py-3 text-left text-xs font-medium text-gray-600 dark:text-gray-400 uppercase tracking-wider">Team</th>
                <th class="px-6 py-3 text-right text-xs font-medium text-gray-600 dark:text-gray-400 uppercase tracking-wider">Points</th>
                <th class="px-6 py-3 text-right text-xs font-medium text-gray-600 dark:text-gray-400 uppercase tracking-wider">Wins</th>
              </tr>
            </thead>
            <tbody class="divide-y divide-gray-200 dark:divide-gray-800">
              <tr *ngFor="let standing of constructorStandings()?.ConstructorStandings; let i = index"
                class="hover:bg-gray-50 dark:hover:bg-gray-900 transition-colors cursor-pointer" [style.animation-delay.s]="i * 0.05">
                <td class="px-6 py-4 whitespace-nowrap">
                  <span class="inline-flex items-center justify-center w-8 h-8 rounded-full text-sm font-bold"
                    [class.bg-yellow-500]="standing.position === '1'" [class.text-black]="standing.position === '1'"
                    [class.bg-gray-400]="standing.position === '2'" [class.text-black]="standing.position === '2'"
                    [class.bg-orange-600]="standing.position === '3'" [class.text-white]="standing.position === '3'"
                    [class.bg-gray-200]="standing.position > '3'" [class.text-gray-800]="standing.position > '3'"
                    [class.dark:bg-gray-800]="standing.position > '3'" [class.dark:text-gray-300]="standing.position > '3'">
                    {{ standing.position }}
                  </span>
                </td>
                <td class="px-6 py-4 whitespace-nowrap">
                  <div class="text-sm font-medium text-black dark:text-white">
                    {{ standing.Constructor.name }}
                  </div>
                  <div class="text-xs text-gray-600 dark:text-gray-400">{{ standing.Constructor.nationality }}</div>
                </td>
                <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-bold text-f1-accent">
                  {{ standing.points }}
                </td>
                <td class="px-6 py-4 whitespace-nowrap text-right text-sm text-gray-600 dark:text-gray-300">
                  {{ standing.wins }}
                </td>
              </tr>
            </tbody>
          </table>
        </div>
        <div class="px-6 py-4 bg-gray-100 dark:bg-gray-900 border-t border-gray-200 dark:border-gray-800">
          <a routerLink="/teams"
            class="text-f1-accent hover:text-f1-accent/80 text-sm font-medium inline-flex items-center gap-2">
            View all teams
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
            </svg>
          </a>
        </div>
      </app-card>
    </div>

    <!-- Recent Races -->
    <div class="grid grid-cols-1 gap-6">
      <app-card title="Race Calendar">
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
          <div *ngFor="let race of raceCalendar().slice(0, 6)"
            class="bg-gray-100 dark:bg-gray-900 rounded-lg p-4 border border-gray-200 dark:border-gray-800 hover:border-gray-300 dark:hover:border-gray-700 transition-all cursor-pointer hover:transform hover:scale-105">
            <div class="flex items-center justify-between mb-2">
              <span class="text-xs font-semibold text-f1-accent bg-f1-accent/10 px-2 py-1 rounded">Round {{ race.round
                }}</span>
              <span class="text-xs text-gray-600 dark:text-gray-400">{{ race.date }}</span>
            </div>
            <h4 class="text-black dark:text-white font-bold mb-1 text-lg">{{ race.raceName }}</h4>
            <p class="text-sm text-gray-600 dark:text-gray-400 flex items-center gap-1">
              <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                  d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" />
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                  d="M15 11a3 3 0 11-6 0 3 3 0 016 0z" />
              </svg>
              {{ race.Circuit.Location.locality }}, {{ race.Circuit.Location.country }}
            </p>
            <p class="text-xs text-gray-500 dark:text-gray-500 mt-2">{{ race.Circuit.circuitName }}</p>
          </div>
        </div>
        <div class="mt-6 text-center">
          <a routerLink="/races"
            class="text-f1-accent hover:text-f1-accent/80 text-sm font-medium inline-flex items-center gap-2">
            View full calendar
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
            </svg>
          </a>
        </div>
      </app-card>
    </div>

  </div>
</div>